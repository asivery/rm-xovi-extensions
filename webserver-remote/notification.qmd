AFFECT [[2328484894988065446]]
    IMPORT net.asivery.XoviMessageBroker 1.0
    TRAVERSE [[8397788359424131273]] > [[8397993708429497603]]#[[7713531976371484]] > [[8397993708429497603]]#[[7713694313857736]]
        LOCATE AFTER ALL
        INSERT {
            XoviMessageBroker {
                id: xoviWebServerBroker
                listeningFor: ["webserver-remote$newIP"]
                onSignalReceived: (signal, message) => {
                    httpConnectionDialog.ip = message;
                    httpConnectionDialog.visible = true;
                }
            }

            Rectangle {
                id: httpConnectionDialog
                property string ip: ""

                width: 500
                height: 250

                anchors.top: parent.top
                anchors.right: parent.right
                anchors.margins: 20

                border.width: 3
                border.color: "black"
                visible: false

                Text {
                    width: 500
                    height: 175

                    anchors.top: parent.top

                    horizontalAlignment: Text.AlignHCenter
                    verticalAlignment: Text.AlignVCenter
                    wrapMode: Text.WordWrap

                    font.pointSize: 25

                    text: `Accept connection from ${httpConnectionDialog.ip}?`
                }

                Rectangle {
                    width: 200
                    height: 75

                    anchors.bottom: parent.bottom
                    anchors.left: parent.left
                    anchors.margins: 20

                    border.width: 3
                    border.color: "black"

                    Text {
                        anchors.fill: parent
                        horizontalAlignment: Text.AlignHCenter
                        verticalAlignment: Text.AlignVCenter
                        font.pointSize: 20

                        text: "Ignore"
                    }

                    MouseArea {
                        anchors.fill: parent

                        onClicked: () => {
                            httpConnectionDialog.visible = false;
                        }

                        onPressAndHold: () => {
                            xoviWebServerBroker.sendSimpleSignal(
                                "webserver-remote$banAddress",
                                httpConnectionDialog.ip
                            );
                            httpConnectionDialog.visible = false;
                        }
                    }
                }
                Rectangle {
                    width: 200
                    height: 75

                    anchors.bottom: parent.bottom
                    anchors.right: parent.right
                    anchors.margins: 20

                    border.width: 3
                    border.color: "black"

                    Text {
                        anchors.fill: parent
                        horizontalAlignment: Text.AlignHCenter
                        verticalAlignment: Text.AlignVCenter
                        font.pointSize: 20

                        text: "Accept"
                    }

                    MouseArea {
                        anchors.fill: parent
                        onClicked: () => {
                            xoviWebServerBroker.sendSimpleSignal(
                                "webserver-remote$allowAddress",
                                httpConnectionDialog.ip
                            );
                            httpConnectionDialog.visible = false;
                        }
                    }
                }
            }
        }
    END TRAVERSE
END AFFECT

; Break the settings' check.
AFFECT [[12680323036303530631]]
    IMPORT net.asivery.XoviMessageBroker 1.0
    TRAVERSE [[3819512207256720568]]
        LOCATE BEFORE ALL
        INSERT {
            XoviMessageBroker {
                ~&5972374&~: xoviWebServerBroker
                listeningFor: []
            }
        }
        TRAVERSE [[8398580812105622257]] > [[6502786168]] > [[14125623155555875541]] > [[5542726367840701177]]#[[17318194766280080962]]
            REPLACE [[254522926132630058]] WITH { readonly property bool ~&254522926132630058&~: ~&6504329801&~ }
            REPLACE [[478136262235079021]] WITH { ~&478136262235079021&~: "Access your device files in a web browser." }
            LOCATE BEFORE ALL
            TRAVERSE [[5867847087117778010]]
                LOCATE BEFORE ALL INSERT {
                    ~&5972374&~: attachmentObject
                    property ~&197102514&~ ips: xoviWebServerBroker.sendSimpleSignal("webserver-remote$getAllIPs", "")
                }
                REPLACE [[233736549263054]] WITH {
                    ~&233736549263054&~: "Connect to any of the following addresses to access the interface:\n" + attachmentObject.ips
                }
            END TRAVERSE
        END TRAVERSE
    END TRAVERSE
END AFFECT
